<?xml version="1.0" encoding="gb2312"?>
<!-- $Revision: 1.4 $ -->
<!-- $AUTHOR$ -->
<!-- EN-Revision: 1.11 Maintainer: Gregory Status: ready -->

 <chapter id="chapter-tools">
  <title>工具及安装须知</title>
   
  <para>
   您需要什么样的工具取决于您使用的操作系统。尽管 phpdoc 有很多工作可以在 Windows 下完成，我们仍旧推荐您使用 Linux 或者某种形式的 Unix 系统。您需要以下基本的工具来开展工作：
   <itemizedlist>
    <listitem><simpara>CVS 账号</simpara></listitem>
    <listitem><simpara>CVS 客户端</simpara></listitem>
    <listitem><simpara>文本编辑器</simpara></listitem>
   </itemizedlist>
   最基本的操作，是用 CVS 客户端校验（即下载）文件，然后编辑，最后提交（即上传）到服务器上。您当然可以找到比简单的纯文本编辑器更好的工具来编辑 XML 文件，纯文本编辑器只是最低的要求。以下是一些有用的工具：
   <itemizedlist>
    <listitem><simpara>XML [capable] editor</simpara></listitem>
    <listitem><simpara>XML 文件的测试工具</simpara></listitem>
   </itemizedlist>
   在以下的段落中，您可以找到关于如果找到这些工具以及如何使它们为您工作的信息。
  </para>

  <para>
   以上列表中的最后一项，也就是“XML 文件的测试工具”，是最难设置使用的，因为您需要一份完整的phpdoc 目录树以及您所翻译语种的文件的拷贝。同时，您还需要安装 DocBook 文件，以及一些其它的工具。可阅读版本的手册以及其它格式，例如 PDF、RTF 格式的版本是用 <ulink url="&url.jade;">Jade</ulink> 和 <ulink url="&url.nwalsh;">Norman Walsh's Modular DocBook Stylesheets</ulink> 创建的。制作其它格式的文档，还需要用到其它更多的工具。我们建议您安装好样式表单和 Jade 以测试您的工作成果，否则您很容易给其它工作人员造成令人头痛的问题，或者会导致手册的自动在线更新系统停止工作。
  </para>

  <para>
   <emphasis>
    如果您有其它更好的 XML 编辑器，或者其它在这里提及的工具的相关信息，请告知文档的维护人员：
    <ulink url="&email.phpdoc;">&email.phpdoc;</ulink>.
   </emphasis>
  </para>
  
  <sect1 id="tools-on-linux">
   <title>基于 Linux 平台的工具</title>
  
   <para>
    尽管在 Linux 系统下，许多工具已经被预安装了，我们仍然收集了一些有用的信息，以便当您的系统没有这些工具时，您能够方便地获得和安装这些工具。
   </para>
   
   <para>
    您首先需要安装您最顺手的文本编辑器和 CVS 系统。虽然用最简单的文本编辑器，例如 vi 就可以撰写 XML 文档，我们仍然推荐您使用 XML/SGML 的编辑器，因为它们能够在您的编辑工作中给您提供帮助，同时保证您的 XML 文档符合 DTD (Document Type Definition，文档规则定义)的定义。Emacs+PSGML 是一种非常好的，同时也是免费的 XML/SGML 编辑器。Emacs 和 CVS 都是任何版本的 Linux 系统的一部分，您可以直接使用它们。
   </para>

   <para>
    除此之外，您还需要 <ulink url="&url.autoconf;">autoconf</ulink> 来建立 phpdoc 的 GNU 设置脚本程序。很多 Linux 版本都已经安装了 autoconf，您也可以在以下地址找到其最新版本：
    <itemizedlist>
     <listitem>
      <simpara><ulink url="&url.autoconf.ftp;">&url.autoconf.ftp;</ulink></simpara>
     </listitem>
    </itemizedlist>
   </para>

   <sect2 id="tools-on-linux-obtaining">
    <title>工具的获取</title>

    <para>
     为了简化安装撰写 PHP 文档所必需工具的过程，我们将描述如何从 sourceware 镜像站点下载和安装 RPM 源文件。您需要事先在您要安装软件的机器上安装好 <ulink url="&url.rpm;">RPM</ulink> 并使之正常运行。
    </para>

    <para>
     这些工具都是独立的安装包。如果您希望的话，您可以在原作者的网站上下载并直接安装它们。您并不需要使用这些 RPM 的源文件，如何从原作者的网站上安装这些独立的安装包已经超出了本指引文档的范围，这里不在过多叙述。
    </para>

    <para>
     RPM 以及必要的软件可以在如下地址找到：
    </para>

    <para>
     <itemizedlist>
      <listitem>
       <simpara>
        <ulink url="&url.docbookmirror1;">&url.docbookmirror1;</ulink>
       </simpara>
      </listitem>

      <listitem>
       <simpara>
        <ulink url="&url.docbookmirror2;">&url.docbookmirror2;</ulink>
       </simpara>
      </listitem>
     </itemizedlist>
    </para>

    <para>
     您需要下载如下文件：
     <itemizedlist>
      <listitem><simpara>docbook-4.x.src.rpm（请参阅以下说明）</simpara></listitem>
      <listitem><simpara>jade-1.2.x-4.src.rpm</simpara></listitem>
      <listitem><simpara>jadetex-2.x-0.src.rpm</simpara></listitem>
      <listitem><simpara>psgml-1.2.x-1.src.rpm</simpara></listitem>
      <listitem><simpara>sgml-common-0.1-3.src.rpm</simpara></listitem>
      <listitem><simpara>stylesheets-0.10-2.src.rpm</simpara></listitem>
     </itemizedlist>
    </para>

    <para>
     这些安装包将不时的被更新，因此请确认您下载的是以上网站提供的最新版本。（更新后的文件名可能会和列出的不同，因此当您发现以上提到的软件的新版本，请告知我们以便我们更新以上列表中的文件名。）
    </para>
    
    <note>
     <para>
      我们目前使用 DocBook 4.1.2 来撰写 phpdoc 文件，该版本使得我们可以进行基于 OO 的文档处理（目前还未使用）。同时我们使用了很多新的结构元素，因此 3.x 版本的 DocBook 不在可用。在 phpdoc 目录下，4.1.2 版的 DTD 也使用，但目前还缺少生成输出文件必要的样式表单。
     </para>
    </note>
    
    <para>
     您也可以考虑使用 <ulink url="&url.openjade;">OpenJade</ulink>，它是 Jade 的一个更便于维护的延伸版本。
    </para>
   </sect2>

   <sect2 id="tools-on-linux-installing">
    <title>工具的安装</title> 

    <para>
     工具的安装比较简单。如果您将以上文件下载到了各自独立的目录中，仅需简单的运行以下命令：
    </para>
   
    <para>
     <informalexample>
      <programlisting>
$ rpm -Uvh *.rpm
      </programlisting>
     </informalexample>
    </para>

    <para>
     或者，您可以按照以下顺序一个一个地执行这些命令：
     <informalexample>
      <programlisting>
$ rpm -Uvh docbook-4.x.src.rpm
$ rpm -Uvh jade-1.2.x-4.src.rpm
$ rpm -Uvh jadetex-2.x-0.src.rpm
$ rpm -Uvh psgml-1.2.x-1.src.rpm
$ rpm -Uvh sgml-common-0.1-3.src.rpm
$ rpm -Uvh stylesheets-0.10-2.src.rpm
      </programlisting>
     </informalexample>
    </para>

    <para>
     执行完毕后，您便安装好了校验您的 PHP 文档的工作成果所必须的工具。
    </para>

   </sect2>
  </sect1>

  <sect1 id="tools-on-windows">
   <title>基于 Windows 平台的工具</title>
  
   <para>
    尽管 phpdoc 的环境是基于许多 Unix 工具和技术的，在 Windows 下也有很多方法来完成这些工作。在 Windows 环境下建立起 CVS 和 DocBook 的运行环境并不会太困难。不过，您将主要依靠键盘来完成大部分的工作，而非在 Windows 下使用较多的鼠标。
   </para>
   
   <sect2 id="tools-on-windows-obtaining">
    <title>工具的获取</title>

    <para>
     您需要和 Linux 系统下相同的工具，其中最基本的是 CVS 客户端。您可以在 <ulink url="&url.cvs-win;">CVSHome.org</ulink> 网站的 Win32 下载区找到一个简单的 CVS 命令行工具。我们不推荐使用诸如 WinCVS 的图形化界面的工具，因为它们常常把文件错误的放置于资源库内（例如放置文件名中包含有有大写字母的文件等）。最好的选择是使用命令行工具，这样您可以自己控制整个操作过程。
    </para>
    
    <para>
     关于 XML 编辑器，我们推荐您不要使用 WYSIWYG XML 编辑器，例如 XML Spy，因为它们友好的自动缩进以及一些优化功能会使您编辑的 XML 文档面目全非，而由此产生的系统自动发布到<link linkend="chapter-maillist">邮件列表</link> 的内容将变得毫无意义。如果您愿意试试的话，Emacs 也可以在 Windows 下使用。
    </para>
   
    <para>
     如果您希望自己生成一些可阅读版本的文档，或者希望能够在提交文件前做一番校验（我们也建议您这么做），您将需要更多的工具。在 Windows 下开展这些工作，您需要如下的工具：

     <itemizedlist>
      <listitem>
       <simpara>
        <ulink url="&url.win.cygwin;">Cygwin (Windows 下的 Linux 工具，文件比较大)</ulink>
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        <ulink url="&url.jade;">Jade (语法分析器，请下载 Windows 版本)</ulink> 或者 <ulink url="&url.openjade;">OpenJade</ulink>
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        <ulink url="&url.nwalsh;">Norman Walsh 的标准 DocBook 样式表单</ulink>
       </simpara>
      </listitem>
     </itemizedlist>
     注意如果您使用 Cygwin，则无需另外下载 CVS 的客户端，因为 Cygwin 自带有内建的 CVS 客户端。
    </para>
   </sect2>

   <sect2 id="tools-on-windows-installing">
    <title>工具的安装</title> 

    <para>
     您需要下载并安装 Cygwin 工具。请访问其网站，点击“Install Now!”的标志，然后运行下载的 <filename>setup.exe</filename> 即可。它将指导您的整个安装过程。这些工具是可在 Windows 下运行的 Unix 工具，诸如 sed、awk、autoconf、make、perl 等的标准接口。
    </para>
    
    <note>
     <para>
      您需要注意的是 cygwin 现在已经发展成为了一个非常庞大的工程，它包含了很多被移植到 Windows 下的程序（例如 postgres 和 apache），尽管 phpdoc 工程并不需要这些程序。由于 cygwin 中一些基本的工具是相互关联，相互依赖的，因此我们无法给您一个 phpdoc 工程需要的组建清单。如果您找出了可满足 phpdoc 工程需求的 cygwin 最小化安装方案，请务必和我们联系，并将您的解决方案发送给我们。
     </para>
    </note>
    
    <para>
     从程序菜单中运行“Cygwin Bash Shell”命令（该菜单可以在上一步操作中添加）， 会出现一个和 Unix 下的 bash 环境类似的命令行。如果您从未使用过 bash 或者 Unix，则您需要注意在路径中使用的是斜杠(/)而非反斜杠(\)。例如，如果您希望访问  <literal>c:</literal> 盘下的 <literal>foo</literal> 目录，则路径应该写成 <literal>c:/foo</literal>，而非 <literal>c:\foo</literal>。
    </para>
    
    <warning>
     <simpara>
       请不要在 Cygwin 下使用 symlink，这是该系统的一个错误。（Jade 不支持它们，而且该外壳本身也不能很好的处理它们。）
     </simpara>
    </warning>
    
    <para>
     您可以使用和 Windows 系统类似的 <literal>cd</literal> 命令将当前目录切换到您的 phpdoc 目录，同时，Cygwin 也支持 <literal>dir</literal> 命令。
    </para>

    <para>
     如果您还没有完整的 phpdoc 文件，请运行 CVS （已经内置到了 Cygwin中）。请查阅本文档“<link linkend="chapter-cvs">利用 CVS 开展工作</link>”一节以获取更多关于 CVS 的信息。
    </para>
    
    <note>
     <simpara>
      如果您希望在以下步骤中使用其它的目录，则您可能需要手动修改 <filename>phpdoc/configure.in</filename> 文件。如果您一定要这么做，我们无法提供更多的技术支持。在这种情况下，您在执行 configure 脚本的时候，需要通过 <literal>--with-dsssl=C:/path/to/dsssl</literal> 参数指明 DSSSL 的路径。
     </simpara>
    </note>
    
    <para>
     请确认您的当前目录是 <literal>phpdoc</literal> 放置的目录。（即如果您运行 <literal>ls</literal> 命令，将看到 <literal>phpdoc</literal> 被显示出来。）
    </para>
    
    <para>
     输入 <literal>mkdir phpdoc-tools</literal> 命令，然后：
    </para>

    <para>
     <itemizedlist>
      <listitem><simpara>将 Jade 解压缩到 <literal>phpdoc-tools/jade</literal> 目录；</simpara></listitem>
      <listitem><simpara>将 Norman Walsh 的 DSSSL 文件解压缩到 <literal>phpdoc-tools/dsssl/docbook</literal> 目录；</simpara></listitem>
     </itemizedlist>
    </para>

    <para>
     对于生成手册的 HTML 版本来说，XSL 样式表单<emphasis>并非必须</emphasis>的，因为系统将默认使用 DSSSL样式表单。如果您希望尝试用 XSL 来代替 DSSSL，则请 Norman Walsh 的 XSL 文件解压缩到 <literal>phpdoc-tools/xsl/docbook</literal>下。请访问 <ulink url="&url.nwalsh.xsl;">&url.nwalsh.xsl;</ulink> 以获取更多信息以及可下载的文件。
    </para>

    <para>
     除此以外，您还需要一份可以工作的 4.x 版本的 PHP 来生成手册。在 Windows 系统下，您需要在 <filename>phpdoc-tools</filename> 目录下放置一个 <filename>php.bat</filename> 文件，并在该文件中写入一行 PHP 的调用命令。您可以使用 <filename>php.ini</filename> 的建议配置作为 PHP 脚本的默认设置，尽管这些设置与 phpdoc PHP 脚本的要求有所不同。您可以在 <filename>phpdoc/scripts</filename> 找到我们推荐的 <filename>php.ini</filename> 配置文件。以下这行内容是调用 PHP 命令的一个范例，它通常都能正常的工作（您需要将路径改为您 PHP 的安装路径）：
     <informalexample>
      <programlisting>
       @"C:\Program Files\PHP\php.exe" %1 %2 %3 %4 %5 %6 %7 %8 %9
      </programlisting>
     </informalexample>
    </para>
    
    <para>
     请检查您当前的目录结构是否如下所示：
     <informalexample>
      <programlisting>
+--phpdoc
|  |
|  +--CVS
|  |
|  +--en
|  |
|  \--...
|
\--phpdoc-tools
   |
   +--dsssl
   |  |
   |  \--docbook (包含有 docbook.dcl 等文件……)
   |
   +--jade (包含有 jade.exe 等文件……)
   |
   +--xsl (可选！)
   |  |
   |  \--docbook (等等)
   |
   \--php.bat
      </programlisting>
     </informalexample>
    </para>
    
    <para>
     现在请切换到 <literal>phpdoc</literal> 目录，然后运行：
     <informalexample>
      <programlisting>
autoconf
./configure --with-lang=your_language_code
      </programlisting>
     </informalexample>
     请用您当前工作的语言代码（简体中文为“zh”）代替以上参数中的 <literal>your_language_code</literal>。<literal>--with-lang</literal> 参数是可选的。如果您没有指定，该参数的默认值是 <literal>en</literal>，即英文。
    </para>
    
    <para>
     如果没有发生任何错误，您就可以开始您的工作了。否则，您可以查看“DocBook：The Definitive Guide（DocBook 明确向导）”一书中的“<ulink url="&url.docbook.appa;">安装附录</ulink>”。如果您认为问题是出在生成系统中，请发邮件到<link linkend="chapter-maillist">邮件列表</link>询问。
    </para>

   </sect2>
  </sect1>
  
  <sect1 id="tools-for-xsl">
   <title>XML 样式表单相关工具</title>
  
   <para>
    为了能够成功的使用 XML 样式表单，您必须有一种 XSLT 处理器以及 XSL DocBook 样式表单。这些已经足够用来生成文档的 HTML 版本，如果您还希望能够生成一个方便打印的版本，则您还需要一个 FO 处理器。
   </para>
   
   <para>
    这是一个不取决于操作系统的部分，因为大部分的工具都是用 Java 语言来开发的，或至少提供 Java版本。这也就是说，您可以在任何具有 Java 虚拟机的操作系统上使用它们。请访问 
    <ulink url="&url.sunjava;">Java 的主页</ulink>以获取更多信息。
   </para>
   
   <note>
    <para>
     通过 XSL 样式表单来使用 <literal>phpdoc</literal> 的 XML 源文档生成各种不同格式的版本，目前是<emphasis>可选的</emphasis>。这个方法目前并不像 DSSSL 样式表单一样已经被良好的支持，但是它是一种很有前景的技术。如果您不希望使用 XSL 样式表单的话，您并不需要安装这里提及的任何工具。尽管如此，我们计划在未来的 HTML 版本，甚至可能在 PDF 的生成工作中使用 XSLT 技术，如果我们最终能够使之正确的工作的话。
    </para>
   </note>
  
   <para>
    XSLT 处理器：
    <itemizedlist>
     <listitem>
      <simpara>
       Saxon: <ulink url="&url.xsl.saxon;">&url.xsl.saxon;</ulink>
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       Xalan: <ulink url="&url.xsl.xalan;">&url.xsl.xalan;</ulink>
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       Gnome LibXSLT: <ulink url="&url.xsl.libxslt;">&url.xsl.libxslt;</ulink>，Windows 版本：<ulink url="&url.xsl.libxslt.win;">&url.xsl.libxslt.win;</ulink>。
      </simpara>
     </listitem>
    </itemizedlist>
   </para>
   
   <note>
    <para>
     我们做过测试，其它的 XSLT 处理器，例如 XT 和 MSXML，它们无法处理 DocBook 的 XSL 样式表，因此它们无法用在即时是最简单的 HTML 生成工作中。
    </para>
   </note>
   
   <para>
    XSL DocBook 样式表: <ulink url="&url.xsl.style;">&url.xsl.style;</ulink>
   </para>
	
   <para>
    FO 处理器：
    <itemizedlist>
     <listitem>
      <simpara>
       PassiveTeX: <ulink url="&url.xsl.passivetex;">&url.xsl.passivetex;</ulink>
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       FOP: <ulink url="&url.xsl.fop;">&url.xsl.fop;</ulink>
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       XEP: <ulink url="&url.xsl.xep;">&url.xsl.xep;</ulink>
      </simpara>
     </listitem>
    </itemizedlist>
   </para>
  
  </sect1>
 </chapter>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"howto.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->

