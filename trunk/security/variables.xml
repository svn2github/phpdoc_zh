<?xml version="1.0" encoding="iso-8859-1"?>
<!-- EN-Revision: 1.1 Maintainer: lm92 Status: ready -->
<chapter id="security.variables">
   <title>User Submitted Data</title>
   <para>
    很多PHP程序所存在的重大弱点并不是PHP语言本身的问题，而是编程者的安全意识不高而导致的。因此，你必须时时注意每一段代码可能存在的问题，去发现非正确数据提交时可能创成的影响。
    <example>
     <title>使用变量时的危险做法</title>
     <programlisting role="php">
<![CDATA[
<?php
// 从用户目录中删除一个文件，或者……能删除更多的东西？
unlink ($evil_var);

// 记录用户的登陆，或者……能否在 /etc/passwd 添加数据？
fwrite ($fp, $evil_var);

// 执行一些普通的命令，或者……可以执行 rm -rf * ？
system ($evil_var);
exec ($evil_var);

?>
]]>
     </programlisting>
    </example>
    你必须时常留意你的代码，以确保每一个从客户端提交的变量都经过适当的检查，然后问自己以下一些问题：
    <itemizedlist>
     <listitem>
      <simpara>
       这些代码只能对你所期望的文件产生作用吗？
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       非正常的数据被提交后能否产生作用？
      </simpara>
     </listitem>
     <listitem>
     <simpara>
       这些代码能否处理异常情况？
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       这些代码是否和其它有问题的代码一齐使用？Can this be used in conjunction with other scripts in a negative
       manner?
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       是否所有的事务都会被记录？
      </simpara>
     </listitem>
    </itemizedlist>
    在写代码的时候问自己这些问题，否则以后你可能要为了增加安全性而重写代码了。注意了这些问题的话，也许还不完全能保证你的系统安全，但是至少可以提高安全性。
   </para>
   <para>
    除此之外，你还要考虑关闭 register_globals 、 magic_quotes 或者其它使你编程更方便但会挠乱代码及变量值的设置。在开发时，你可以使用 error_reporting(E_ALL) 模式帮助你发现变量使用前是否有被检查或被初始化，这样你就可以防止某些非正常的数据的挠乱了。
   </para>
  </chapter>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
