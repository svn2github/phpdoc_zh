<?xml version="1.0" encoding="gb2312"?>
<!-- $Revision: 1.4 $ -->
<!-- $Author: dallas $ -->
<!-- EN-Revision: 1.10 Maintainer: dallas Status: ready -->
<!-- CREDITS: lm92 -->
  <refentry id="function.fopen">
   <refnamediv>
    <refname>fopen</refname>
    <refpurpose>打开文件或者 URL</refpurpose>
   </refnamediv>
   <refsect1>
    <title>说明</title>
     <methodsynopsis>
      <type>resource</type><methodname>fopen</methodname>
      <methodparam><type>string</type><parameter>filename</parameter></methodparam>
      <methodparam><type>string</type><parameter>mode</parameter></methodparam>
      <methodparam choice="opt"><type>int</type><parameter>use_include_path</parameter></methodparam>
      <methodparam choice="opt"><type>resource</type><parameter>zcontext</parameter></methodparam>
     </methodsynopsis>
    <simpara>
     <function>fopen</function> 将
     <parameter>filename</parameter>
     指定的名字资源绑定到一个流上。如果
     <parameter>filename</parameter>
     是 "scheme://..." 的格式，则被当成一个
     URL，PHP 将搜索协议处理器（也被称为封装协议）来处理此模式。如果该协议尚未注册封装协议，PHP
     将发出一条消息来帮助检查脚本中潜在的问题并将
     <parameter>filename</parameter>
     当成一个普通的文件名继续执行下去。
    </simpara>
    <simpara>
     如果 PHP 认为
     <parameter>filename</parameter>
     指定的是一个本地文件，将尝试在该文件上打开一个流。该文件必须是
     PHP 可以访问的，因此需要确认文件访问权限允许该访问。如果激活了
     &safemode; 或者
     <link linkend="ini.open-basedir">open_basedir</link>
     则会应用进一步的限制。
    </simpara>
    <simpara>
     如果 PHP 认为
     <parameter>filename</parameter>
     指定的是一个已注册的协议，而该协议被注册为一个网络
     URL，PHP 将检查并确认
     <link linkend="ini.allow-url-fopen">allow_url_fopen</link>
     已被激活。如果关闭了，PHP 将发出一个警告，而 fopen 的调用则失败。
    </simpara>
    <note>
     <simpara>
      所支持的协议列表见<xref linkend="wrappers"/>。
     </simpara>
    </note>
    <para>
     <parameter>mode</parameter>
     参数指定了所要求到该流的访问类型。可以是以下：
     <table>
      <title>
       <function>fopen</function> 中的
       <parameter>mode</parameter> 的可能值列表
      </title>
      <tgroup cols="2">
       <thead>
        <row>
         <entry><parameter>mode</parameter></entry>
         <entry>说明</entry>
        </row>
       </thead>
       <tbody>
        <row>
         <entry><literal>'r'</literal></entry>
         <entry>
          只读方式打开，将文件指针指向文件头。
         </entry>
        </row>
        <row>
         <entry><literal>'r+'</literal></entry>
         <entry>
          读写方式打开，将文件指针指向文件头。
         </entry>
        </row>
        <row>
         <entry><literal>'w'</literal></entry>
         <entry>
          写入方式打开，将文件指针指向文件头并将文件大小截为零。如果文件不存在则尝试创建之。
         </entry>
        </row>
        <row>
         <entry><literal>'w+'</literal></entry>
         <entry>
          读写方式打开，将文件指针指向文件头并将文件大小截为零。如果文件不存在则尝试创建之。
         </entry>
        </row>
        <row>
         <entry><literal>'a'</literal></entry>
         <entry>
          写入方式打开，将文件指针指向文件末尾。如果文件不存在则尝试创建之。
         </entry>
        </row>
        <row>
         <entry><literal>'a+'</literal></entry>
         <entry>
          读写方式打开，将文件指针指向文件末尾。如果文件不存在则尝试创建之。
         </entry>
        </row>
       </tbody>
      </tgroup>
     </table>
    </para>
    <note>
     <para>
      <parameter>mode</parameter> 可以包括字母
      'b'，仅在区分二进制和文本文件的系统下有用（例如
      Windows。在 UNIX 下没有用）。如果不需要将被忽略。鼓励用户包括
      'b' 标记以使脚本具有更好的移植性。
     </para>
    </note>
    <para>
     如果也需要在
     <link linkend="ini.include-path">include_path</link>
     中搜寻文件的话，可以将可选的第三个参数
     <parameter>use_include_path</parameter>
     设为 '1' 或 &true;。
    </para>
    <para>
     可选的第四个参数
     <parameter>zcontext</parameter>
     用于指定调整参数和回调。
    </para>
    <simpara>
     如果打开失败，本函数返回 &false;。
    </simpara>
    <para>
     <example>
      <title><function>fopen</function> 例子</title>
      <programlisting role="php">
<![CDATA[
<?php
$handle = fopen ("/home/rasmus/file.txt", "r");
$handle = fopen ("/home/rasmus/file.gif", "wb");
$handle = fopen ("http://www.example.com/", "r");
$handle = fopen ("ftp://user:password@example.com/somefile.txt", "w");
?>
]]>
      </programlisting>
     </example>
    </para>
    <simpara>
     如果在用服务器模块版本的 PHP
     时在打开和写入文件上遇到问题，记住要确保所使用的文件是服务器进程所能够访问的。
    </simpara>
    <para>
     在 Windows 平台上，要小心转义文件路径中的每个反斜线，或者用斜线。
     <informalexample>
      <programlisting role="php"> 
<![CDATA[
<?php
$handle = fopen ("c:\\data\\info.txt", "r");
?>
]]>
      </programlisting>
     </informalexample>
    </para>
    <simpara>
     参见<xref linkend="wrappers"/>，<function>fclose</function>，<function>fgets</function>，<function>fsockopen</function>，<function>file</function>，<function>file_exists</function>，<function>is_readable</function>，<function>socket_set_timeout</function>
     和 <function>popen</function>。
    </simpara>
   </refsect1>
  </refentry>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../../../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
