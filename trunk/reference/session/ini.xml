<?xml version="1.0" encoding="gb2312"?>
<!-- $Revision: 1.3 $ -->
<!-- $Author: dallas $ -->
<!-- EN-Revision: 1.39 Maintainer: dallas Status: ready -->
<section id="session.configuration">
 &reftitle.runtime;
 &extension.runtime;
 <para>
 <table>
  <title>会话配置选项</title>
  <tgroup cols="4">
   <thead>
    <row>
     <entry>名称</entry>
     <entry>默认值</entry>
     <entry>可修改范围</entry>
     <entry>更新纪录</entry>
    </row>
   </thead>
   <tbody>
    <row>
     <entry>session.save_path</entry>
     <entry>""</entry>
     <entry>PHP_INI_ALL</entry>
     <entry></entry>
    </row>
    <row>
     <entry>session.name</entry>
     <entry>"PHPSESSID"</entry>
     <entry>PHP_INI_ALL</entry>
     <entry></entry>
    </row>
    <row>
     <entry>session.save_handler</entry>
     <entry>"files"</entry>
     <entry>PHP_INI_ALL</entry>
     <entry></entry>
    </row>
    <row>
     <entry>session.auto_start</entry>
     <entry>"0"</entry>
     <entry>PHP_INI_ALL</entry>
     <entry></entry>
    </row>
    <row>
     <entry>session.gc_probability</entry>
     <entry>"1"</entry>
     <entry>PHP_INI_ALL</entry>
     <entry></entry>
    </row>
    <row>
     <entry>session.gc_divisor</entry>
     <entry>"100"</entry>
     <entry>PHP_INI_ALL</entry>
     <entry>自 PHP 4.3.2 起可用。</entry>
    </row>
    <row>
     <entry>session.gc_maxlifetime</entry>
     <entry>"1440"</entry>
     <entry>PHP_INI_ALL</entry>
     <entry></entry>
    </row>
    <row>
     <entry>session.serialize_handler</entry>
     <entry>"php"</entry>
     <entry>PHP_INI_ALL</entry>
     <entry></entry>
    </row>
    <row>
     <entry>session.cookie_lifetime</entry>
     <entry>"0"</entry>
     <entry>PHP_INI_ALL</entry>
     <entry></entry>
    </row>
    <row>
     <entry>session.cookie_path</entry>
     <entry>"/"</entry>
     <entry>PHP_INI_ALL</entry>
     <entry></entry>
    </row>
    <row>
     <entry>session.cookie_domain</entry>
     <entry>""</entry>
     <entry>PHP_INI_ALL</entry>
     <entry></entry>
    </row>
    <row>
     <entry>session.cookie_secure</entry>
     <entry>""</entry>
     <entry>PHP_INI_ALL</entry>
     <entry>自 PHP 4.0.4 起可用。</entry>
    </row>
    <row>
     <entry>session.use_cookies</entry>
     <entry>"1"</entry>
     <entry>PHP_INI_ALL</entry>
     <entry></entry>
    </row>
    <row>
     <entry>session.use_only_cookies</entry>
     <entry>"1"</entry>
     <entry>PHP_INI_ALL</entry>
     <entry>自 PHP 4.3.0 起可用。</entry>
    </row>
    <row>
     <entry>session.referer_check</entry>
     <entry>""</entry>
     <entry>PHP_INI_ALL</entry>
     <entry></entry>
    </row>
    <row>
     <entry>session.entropy_file</entry>
     <entry>""</entry>
     <entry>PHP_INI_ALL</entry>
     <entry></entry>
    </row>
    <row>
     <entry>session.entropy_length</entry>
     <entry>"0"</entry>
     <entry>PHP_INI_ALL</entry>
     <entry></entry>
    </row>
    <row>
     <entry>session.cache_limiter</entry>
     <entry>"nocache"</entry>
     <entry>PHP_INI_ALL</entry>
     <entry></entry>
    </row>
    <row>
     <entry>session.cache_expire</entry>
     <entry>"180"</entry>
     <entry>PHP_INI_ALL</entry>
     <entry></entry>
    </row>
    <row>
     <entry>session.use_trans_sid</entry>
     <entry>"0"</entry>
     <entry>PHP_INI_ALL</entry>
     <entry>在 PHP &lt;= 4.2.3 是 PHP_INI_ALL，在 PHP &lt; 5 是 PHP_INI_PERDIR。自 PHP 4.0.3 起可用。</entry>
    </row>
    <row>
     <entry>session.bug_compat_42</entry>
     <entry>"1"</entry>
     <entry>PHP_INI_ALL</entry>
     <entry>自 PHP 4.3.0 起可用。</entry>
    </row>
    <row>
     <entry>session.bug_compat_warn</entry>
     <entry>"1"</entry>
     <entry>PHP_INI_ALL</entry>
     <entry>自 PHP 4.3.0 起可用。</entry>
    </row>
    <row>
     <entry>session.hash_function</entry>
     <entry>"0"</entry>
     <entry>PHP_INI_ALL</entry>
     <entry>自 PHP 5.0.0 起可用。</entry>
    </row>
    <row>
     <entry>session.hash_bits_per_character</entry>
     <entry>"4"</entry>
     <entry>PHP_INI_ALL</entry>
     <entry>自 PHP 5.0.0 起可用。</entry>
    </row>
    <row>
     <entry>url_rewriter.tags</entry>
     <entry>"a=href,area=href,frame=src,form=,fieldset="</entry>
     <entry>PHP_INI_ALL</entry>
     <entry>自 PHP 4.0.4 起可用。</entry>
    </row>
    
<!-- Not yet
    <row>
     <entry>session.encode_sources</entry>
     <entry>"globals</entry>
     <entry>track"</entry>
     <entry></entry>
    </row>
-->

   </tbody>
  </tgroup>
 </table>
 &ini.php.constants;
 </para>
 <para>
  会话管理系统支持许多配置选项，可以在自己的 &php.ini; 文件中设定。这里只是个简短的概览。
 <variablelist>

  <varlistentry id="ini.session.save-handler">
   <term>
    <parameter>session.save_handler</parameter>
    <type>string</type>
   </term>
   <listitem>
    <simpara>
     <literal>session.save_handler</literal> 定义了来存储和获取与会话关联的数据的处理器的名字。默认为
     <literal>files</literal>。参见
     <function>session_set_save_handler</function>。
    </simpara>
   </listitem>
  </varlistentry>

  <varlistentry id="ini.session.save-path">
   <term>
    <parameter>session.save_path</parameter>
    <type>string</type>
   </term>
   <listitem>
    <simpara>
     <literal>session.save_path</literal> 定义了传递给存储处理器的参数。如果选择了默认的
     files 文件处理器，则此值是创建文件的路径。默认为
     <literal>/tmp</literal>。参见
     <function>session_save_path</function>。
    </simpara>
    <para>
     此指令还有一个可选的 N 参数来决定会话文件分布的目录深度。例如，设定为
     <literal>'5;/tmp'</literal> 将使创建的会话文件和路径类似于
     <literal>/tmp/4/b/1/e/3/sess_4b1e384ad74619bd212e236e52a5a174If</literal>。要使用
     N 参数，必须在使用前先创建好这些目录。在 <filename>ext/session</filename>
     目录下有个小的 shell 脚本名叫 <filename>mod_files.sh</filename>
     可以用来做这件事。此外注意如果使用了 N 参数并且 N 大于
     0，那么将不会执行自动垃圾回收，更多信息见 &php.ini;。另外如果用了 N
     参数，要确保将 <literal>session.save_path</literal> 的值用双引号 "quotes"
     括起来，因为分隔符分号（ <literal>;</literal>）在 &php.ini; 中也是注释符号。
    </para>
    <warning>
     <para>
      如果将此设定为一个全局可读的目录，例如
      <filename>/tmp</filename>（默认值），服务器上的其他用户有可能通过该目录的文件列表破解会话。
     </para>
    </warning>
    <note>
     <simpara>
      在 PHP 4.3.6 之前，Windows 用户必须修改此选项以使用 PHP 的会话函数。必须指定一个合法路径，例如：<filename>c:/temp</filename>。
     </simpara>
    </note>
   </listitem>
  </varlistentry>

  <varlistentry id="ini.session.name">
   <term>
    <parameter>session.name</parameter>
    <type>string</type>
   </term>
   <listitem>
    <simpara>
     <literal>session.name</literal> 指定会话名以用做 cookie 的名字。只能由字母数字组成，默认为
     <literal>PHPSESSID</literal>。参见 <function>session_name</function>。
    </simpara>
   </listitem>
  </varlistentry>
  
  <varlistentry id="ini.session.auto-start">
   <term>
    <parameter>session.auto_start</parameter>
    <type>boolean</type>
   </term>
   <listitem>
    <simpara>
     <literal>session.auto_start</literal> 指定会话模块是否在请求开始时自动启动一个会话。默认为
     <literal>0</literal>（不启动）。
    </simpara>
   </listitem>
  </varlistentry>

  <varlistentry id="ini.session.serialize-handler">
   <term>
    <parameter>session.serialize_handler</parameter>
    <type>string</type>
   </term>
   <listitem>
    <simpara>
     <literal>session.serialize_handler</literal> 定义用来序列化／解序列化的处理器名字。当前支持
     PHP 内部格式（名为 <literal>php</literal>）和
     WDDX（名为 <literal>wddx</literal>）。如果 PHP 编译时加入了 <link linkend="ref.wddx">WDDX
     支持</link>，则只能用 WDDX。默认为 <literal>php</literal>。
    </simpara>
   </listitem>
  </varlistentry>

  <varlistentry id="ini.session.gc-probability">
   <term>
    <parameter>session.gc_probability</parameter>
    <type>integer</type>
   </term>
   <listitem>
    <simpara>
     <literal>session.gc_probability</literal> 与
     <literal>session.gc_divisor</literal> 合起来用来管理 gc（garbage collection
     垃圾回收）进程启动的概率。默认为 <literal>1</literal>。详见 <link
     linkend="ini.session.gc-divisor">session.gc_divisor</link>。
    </simpara>
   </listitem>
  </varlistentry>

  <varlistentry id="ini.session.gc-divisor">
   <term>
    <parameter>session.gc_divisor</parameter>
    <type>integer</type>
   </term>
   <listitem>
    <simpara>
     <literal>session.gc_divisor</literal> 与
     <literal>session.gc_probability</literal> 合起来定义了在每个会话初始化时启动
     gc（garbage collection 垃圾回收）进程的概率。此概率用
     gc_probability/gc_divisor 计算得来。例如 1/100
     意味着在每个请求中有 1% 的概率启动 gc 进程。<literal>session.gc_divisor</literal>
     默认为 <literal>100</literal>。
    </simpara>
   </listitem>
  </varlistentry>
  
  <varlistentry id="ini.session.gc-maxlifetime">
   <term>
    <parameter>session.gc_maxlifetime</parameter>
    <type>integer</type>
   </term>
   <listitem>
    <simpara>
     <literal>session.gc_maxlifetime</literal> 指定过了多少秒之后数据就会被视为“垃圾”并被清除。
    </simpara>
    <note>
     <para>
      如果不同的脚本具有不同的
      <literal>session.gc_maxlifetime</literal>
      数值但是共享了同一个地方存储会话数据，则具有最小数值的脚本会清理数据。此情况下，与
      <link linkend="ini.session.save-path">session.save_path</link> 一起使用本指令。
     </para>
    </note>
    <note>
     <simpara>
      如果使用默认的基于文件的会话处理器，则文件系统必须保持跟踪访问时间（atime）。Windows
      FAT 文件系统不行，因此如果必须使用 FAT 文件系统或者其他不能跟踪 atime
      的文件系统，那就不得不想别的办法来处理会话数据的垃圾回收。自 PHP 4.2.3
      起用 mtime（修改时间）来代替了 atime。因此对于不能跟踪 atime 的文件系统也没问题了。
     </simpara>
    </note>
   </listitem>
  </varlistentry>

  <varlistentry id="ini.session.referer-check">
   <term>
    <parameter>session.referer_check</parameter>
    <type>string</type>
   </term>
   <listitem>
    <simpara>
     <literal>session.referer_check</literal> 包含有用来检查每个 HTTP
     Referer 的子串。如果客户端发送了 Referer
     信息但是在其中并未找到该子串，则嵌入的会话 ID 会被标记为无效。默认为空字符串。
    </simpara>
   </listitem>
  </varlistentry>

  <varlistentry id="ini.session.entropy-file">
   <term>
    <parameter>session.entropy_file</parameter>
    <type>string</type>
   </term>
   <listitem>
    <simpara>
     <literal>session.entropy_file</literal> 给出了一个到外部资源（文件）的路径，该资源将在会话
     ID 创建进程中被用作附加的熵值资源。例如在许多 Unix 系统下都可以用
     <literal>/dev/random</literal> 或 <literal>/dev/urandom</literal>。
    </simpara>
   </listitem>
  </varlistentry>

  <varlistentry id="ini.session.entropy-length">
   <term>
    <parameter>session.entropy_length</parameter>
    <type>integer</type>
   </term>
   <listitem>
    <simpara>
     <literal>session.entropy_length</literal> 指定了从上面的文件中读取的字节数。默认为
     <literal>0</literal>（禁用）。
    </simpara>
   </listitem>
  </varlistentry>

  <varlistentry id="ini.session.use-cookies">
   <term>
    <parameter>session.use_cookies</parameter>
    <type>boolean</type>
   </term>
   <listitem>
    <simpara>
     <literal>session.use_cookies</literal> 指定是否在客户端用
     cookie 来存放会话 ID。默认为 <literal>1</literal>（启用）。
    </simpara>
   </listitem>
  </varlistentry>

  <varlistentry id="ini.session.use-only-cookies">
   <term>
    <parameter>session.use_only_cookies</parameter>
    <type>boolean</type>
   </term>
   <listitem>
    <simpara>
     <literal>session.use_only_cookies</literal> 指定是否在客户端<emphasis
     role="strong">仅仅</emphasis>使用 cookie 来存放会话 ID。默认为
     <literal>0</literal>（禁用，为向后兼容）。启用此设定可以防止有关通过
     URL 传递会话 ID 的攻击。此设定是 PHP 4.3.0 添加的。
    </simpara>
   </listitem>
  </varlistentry>


  <varlistentry id="ini.session.cookie-lifetime">
   <term>
    <parameter>session.cookie_lifetime</parameter>
    <type>integer</type>
   </term>
   <listitem>
    <simpara>
     <literal>session.cookie_lifetime</literal> 以秒数指定了发送到浏览器的
     cookie 的生命周期。值为 0
     表示“直到关闭浏览器”。默认为
     <literal>0</literal>。参见
     <function>session_get_cookie_params</function> 和
     <function>session_set_cookie_params</function>。
    </simpara>
   </listitem>
  </varlistentry>

  <varlistentry id="ini.session.cookie-path">
   <term>
    <parameter>session.cookie_path</parameter>
    <type>string</type>
   </term>
   <listitem>
    <simpara>
     <literal>session.cookie_path</literal> 指定了要设定会话 cookie 的路径。默认为
     <literal>/</literal>。参见
     <function>session_get_cookie_params</function> 和
     <function>session_set_cookie_params</function>。
    </simpara>
   </listitem>
  </varlistentry>

  <varlistentry id="ini.session.cookie-domain">
   <term>
    <parameter>session.cookie_domain</parameter>
    <type>string</type>
   </term>
   <listitem>
    <simpara>
     <literal>session.cookie_domain</literal> 指定了要设定会话 cookie
     的域名。默认为无，表示根据 cookie 规范产生 cookie 的主机名。参见
     <function>session_get_cookie_params</function> 和
     <function>session_set_cookie_params</function>。
    </simpara>
   </listitem>
  </varlistentry>

  <varlistentry id="ini.session.cookie-secure">
   <term>
    <parameter>session.cookie_secure</parameter>
    <type>boolean</type>
   </term>
   <listitem>
    <simpara>
     <literal>session.cookie_secure</literal> 指定是否仅通过安全连接发送
     cookie。默认为 <literal>off</literal>。此设定是 PHP 4.0.4 添加的。参见
     <function>session_get_cookie_params</function> 和
     <function>session_set_cookie_params</function>。
    </simpara>
   </listitem>
  </varlistentry>

  <varlistentry id="ini.session.cache-limiter">
   <term>
    <parameter>session.cache_limiter</parameter>
    <type>string</type>
   </term>
   <listitem>
    <simpara>
     <literal>session.cache_limiter</literal>
     指定会话页面所使用的缓冲控制方法（none/nocache/private/private_no_expire/public）。默认为
     <literal>nocache</literal>。参见
     <function>session_cache_limiter</function>。
    </simpara>
   </listitem>
  </varlistentry>


  <varlistentry id="ini.session.cache-expire">
   <term>
    <parameter>session.cache_expire</parameter>
    <type>integer</type>
   </term>
   <listitem>
    <simpara>
     <literal>session.cache_expire</literal> 以分钟数指定缓冲的会话页面的存活期，此设定对
     nocache 缓冲控制方法无效。默认为 <literal>180</literal>。参见
     <function>session_cache_expire</function>。
    </simpara>
   </listitem>
  </varlistentry>

  <varlistentry id="ini.session.use-trans-sid">
   <term>
    <parameter>session.use_trans_sid</parameter>
    <type>boolean</type>
   </term>
   <listitem>
    <simpara>
     <literal>session.use_trans_sid</literal> 指定是否启用透明 SID
     支持。默认为 <literal>0</literal>（禁用）。
    </simpara>
    <note>
     <simpara>
      对于 PHP 4.1.2 或以下版本，可以通过加入
      <link linkend="configure.enable-trans-sid"><literal>--enable-trans-sid</literal></link>
      配置选项去编译来启用，从 PHP 4.2.0 起，trans-sid 特性总是被编译。
     </simpara>
     <simpara>
      基于 URL 的会话管理比基于 cookie 的会话管理有更多安全风险。例如用户有可能通过
      email 将一个包含有效的会话 ID 的 URL 发给他的朋友，或者用户总是有可能在收藏夹中存有一个包含会话
      ID 的 URL 来以同样的会话 ID 去访问站点。
     </simpara>
    </note>
   </listitem>
  </varlistentry>
  
  <varlistentry id="ini.session.bug-compat-42">
   <term>
    <parameter>session.bug_compat_42</parameter>
    <type>boolean</type>
   </term>
   <listitem>
    <simpara>
     PHP 4.2.3 以及更低版本有一个未公开的特性／错误，它允许用户在
     <link linkend="ini.register-globals">register_globals</link>
     被禁用的情况下在全局范围内初始化一个会话变量。PHP 4.3.0
     及更高版本会在使用此特性时并且启用了
     <link linkend="ini.session.bug-compat-warn">session.bug_compat_warn</link>
     时发出警告。此特性／错误可以通过关闭此选项而禁用。
    </simpara>
   </listitem>
  </varlistentry>
  
  <varlistentry id="ini.session.bug-compat-warn">
   <term>
    <parameter>session.bug_compat_warn</parameter>
    <type>boolean</type>
   </term>
   <listitem>
    <simpara>
     PHP 4.2.3 以及更低版本有一个未公开的特性／错误，它允许用户在
     <link linkend="ini.register-globals">register_globals</link>
     被禁用的情况下在全局范围内初始化一个会话变量。PHP 4.3.0
     及更高版本会在使用此特性时并且同时启用了
     <link linkend="ini.session.bug-compat-42">session.bug_compat_42</link> 和
     <link linkend="ini.session.bug-compat-warn">session.bug_compat_warn</link>
     时发出警告。
    </simpara>
   </listitem>
  </varlistentry>

  <varlistentry id="ini.session.hash-function">
   <term>
    <parameter>session.hash_function</parameter>
    <type>integer</type>
   </term>
   <listitem>
    <simpara>
     <literal>session.hash_function</literal> 允许用户指定生成会话
     ID 的散列算法。'0' 表示 MD5（128 位），'1' 表示 SHA-1（160 位）。
    </simpara>
    <note>
     <para>
      这是 PHP 5 引进的。
     </para>
    </note>
   </listitem>
  </varlistentry>

  <varlistentry id="ini.session.hash-bits-per-character">
   <term>
    <parameter>session.hash_bits_per_character</parameter>
    <type>integer</type>
   </term>
   <listitem>
    <simpara>
     <literal>session.hash_bits_per_character</literal>
     允许用户定义将二进制散列数据转换为可读的格式时每个字符存放多少个比特。可能值为
     '4'（0-9，a-f），'5'（0-9，a-v），以及 '6'（0-9，a-z，A-Z，"-"，","）。
    </simpara>
    <note>
     <para>
      这是 PHP 5 引进的。
     </para>
    </note>
   </listitem>
  </varlistentry>

  <varlistentry id="ini.url-rewriter.tags">
   <term>
    <parameter>url_rewriter.tags</parameter>
    <type>string</type>
   </term>
   <listitem>
    <simpara>
     <literal>url_rewriter.tags</literal> 指定在使用透明 SID 支持时哪些 HTML
     标记会被修改以加入会话 ID。默认为
     <literal>a=href,area=href,frame=src,input=src,form=fakeentry,fieldset=</literal>。
    </simpara>
    <note>
     <simpara>
      如果要符合 XHTML，去掉 <literal>form</literal> 项并在表单字段前后加上
      &lt;fieldset&gt; 标记。
     </simpara>
    </note>
   </listitem>
  </varlistentry>
 </variablelist>
 </para>

 <para>
  <link
  linkend="ini.track-vars"><literal>track_vars</literal></link> 和
  <link
  linkend="ini.register-globals"><literal>register_globals</literal></link>
  配置选项影响到会话变量是怎样存储和恢复的。
 </para>

 <note>
  <para>
   自 PHP 4.0.3 起，<link
   linkend="ini.track-vars"><literal>track_vars</literal></link> 总是打开的。
  </para>
 </note>

</section>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
